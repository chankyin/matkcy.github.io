<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="text.css" />
<title> Mathematical Finance </title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript"
  src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>


<h1>Hello World</h1>
<p>I'm hosted with GitHub Pages.</p>


<p> When $a \ne 0$, there are two solutions to \(ax^2 + bx + c = 0\) and they are
$$x = {-b \pm \sqrt{b^2-4ac} \over 2a}.$$ </p>



<p> Click <a href="http://matkcy.github.io/link1.html">here</a> to go to yahoo. </p>






<h2> Test </h2>

<p> Testing


<h3> Another header </h3>

<p>
$$ \frac{dS_{t}}{S_{t}} = \mu \, dt + \sigma \, dW_{t}. $$


Itemize:
<ul>
<li> The first item</li>
<li> The second item</li>
<li> The third item </li>
</ul>
<p>
Here is a theorem:
</p>
<p class=theorem><b> Theorem</b>. 
Let $G$ be a group. Immanuel Kant (1724–1804) argued that moral requirements are based on a standard of rationality he dubbed the “Categorical Imperative” (CI). Immorality thus involves a violation of the CI and is thereby irrational. Other philosophers, such as Locke and Hobbes, had also argued that moral requirements are based on standards of rationality. However, these standards were either desire-based instrumental principles of rationality or based on sui generis rational intuitions. Kant agreed with many of his predecessors that an analysis of practical reason will reveal only the requirement that rational agents must conform to instrumental principles. Yet he argued that conformity to the CI (a non-instrumental principle) and hence to moral requirements themselves, can nevertheless be shown to be essential to rational agency. This argument was based on his striking doctrine that a rational will must be regarded as autonomous, or free in the sense of being the author of the law that binds it. The fundamental principle of morality — the CI — is none other than the law of an autonomous will. Thus, at the heart of Kant's moral philosophy is a conception of reason whose reach in practical affairs goes well beyond that of a Humean ‘slave’ to the passions. Moreover, it is the presence of this self-governing reason in each person that Kant thought offered decisive grounds for viewing each as possessed of equal worth and deserving of equal respect. </p>



</p>





<h2>Correlated Brownian motions</h2>

<p>

Correlated Brownian motion are necessary when describing several simultaneous processes governed by SDE's, where upward (downward) movements in one generally result in upward (downward) movements of the other. For example, two foreign currencies may be modelled whose countries have closely linked economies. Correlations could be negative, in which case upward movement of one generally implies downward movement of the other.
</p>

<p>

Generating correlated Brownian motions is simply a matter of generating correlated normal random variables.
</p>


\subsection{Generating correlated normal random variables}




Suppose ${\bf{x}}=(x_{1}, \ldots, x_{n})^{T}$ is a random vector. The variance-covariance matrix ${\bf{C}[\bf{x}]}$ of ${\bf{x}}$ is the $n \times n$ matrix that has $(i,j)$-th entry given by
\[ {\bm C}:={\bm{C}[\bm{x}]}_{ij}:= \textnormal{Cov}(x_{i}, x_{j}). \]

The variance-covariance matrix is the expected value, element by element, of the $n \times n$ matrix computed as 
\[ (\bm{x}-\mathbb{E}[{\bm{x}}])({\bm{x}}-\mathbb{E}[{\bm{x}}])^{T}. \]
Some properties of the covariance matrix ${\bm{C}}$:
\begin{itemize}
\item[(i)] It is symmetric: ${\bm C}^{T} = {\bm C}$.
\item[(ii)] It is {\em positive semi-definite}: ${\bm y}^{T}{\bm C}{\bm y} \ge 0$ for all ${\bm y} \in \mathbb{R}^{n}$. In fact, it is {\em positive definite} (${\bm y}^{T}{\bm C}{\bm y} > 0$ for all non-zero column vectors ${\bm y} \in \mathbb{R}^{n}$) unless one variable is an exact linear combination of the others.
\end{itemize}


Suppose we want to generate the random vector ${\bm x} = (x_{1}, \ldots, x_{n})^{T}$, where ${\bm x} \sim \mathcal{N}({\bm 0}, {\bm C})$? Here, $\mathcal{N}({\bf 0}, {\bm C})$ stands for the distribution of multivariate normal random variables with mean vector  ${\bm 0}$ and variance-covariance matrix ${\bm C}$. Note that it is then easy to handle the case where $\mathbb{E}[{\bm x}] \not = {\bm 0}$.

By way of motivation, suppose we have a vector ${\bm z}=(z_{1}, \ldots, z_{n})^{T}$ of $n$ i.i.d. standard normal variables $z_{i} \sim \mathcal{N}(0,1)$ for $i=1, \ldots, n$. Then, for any given scalars $l_{1}$, $\ldots$, $l_{n}$, we have 
\[ (l_{1}, \ldots, l_{n}) {\bm z} = l_{1} z_{1} + \cdots + l_{n} z_{n} \sim \mathcal{N}(0, l_{1}^{2} + \cdots + l_{n}^{2}) \]
That is, a linear combination of independent standard normal random variables is again normal.


More generally, let ${\bm L}$ be an $n \times n$ matrix. Consider the new vector ${\bm y} = {\bm L} {\bm z}$. Clearly, each element of ${\bm y}$ is normally distributed, and $\mathbb{E}[{\bm y}] = \mathbb{E}[{\bm L} {\bm z}] = {\bm L}\mathbb{E}[{\bm z}] = {\bm 0}$. Furthermore, the variance-covariance matrix of $\bm{y}$ is given by
\begin{eqnarray*}
\mathbb{E}[({\bm y}-\mathbb{E}[{\bm y}])({\bm y}-\mathbb{E}[{\bm y}])^{T}] & = & \mathbb{E}[{\bm y}{\bm y}^{T} ] \\
& = & \mathbb{E}[{\bm L}{\bm z} {\bm z}^{T} {\bm L}^{T}] \\
& = & {\bm L} \mathbb{E}[{\bm z}{\bm z}^{T}] {\bm L} ^{T}\\
&  = & {\bm L} {\bm L}^{T}
\end{eqnarray*}
since $\mathbb{E}[{\bm z}{\bm z}^{T}] = 1$ because
\begin{itemize}
\item elements of ${\bm z}$ are independent: $\mathbb{E}[z_{i}z_{j}] = 0$ for all $i \not = j$.
\item elements of ${\bm z}$ have unit variance: $\mathbb{E}[z_{i}^{2}] = 1$ for all $i$.
\end{itemize}

To summarize: 



\begin{center}
\fbox{
\begin{minipage}{10cm}
$~~$\\
If ${\bm z}=(z_{1}, \ldots, z_{n})^{T}$ is a vector of $n$ i.i.d. standard normal variables, then 
\[ {\bm L}{\bm z} \sim \mathcal{N}({\bm 0}, {\bm L}{\bm L}^{T}). \]
$~~$\\
\end{minipage}
}
\end{center}






Therefore, if we want to generate a random vector $\bm{x}$ with $\mathbb{E}[\bm{x}]=\bm{0}$ and variance-covariance matrix $\bm{C}$, then we can do the following:

\begin{center}
\fbox{
\begin{minipage}{10cm}
$~~$\\

\begin{itemize}
\item[(1)] Generate a vector ${\bf z}=(z_{1}, \ldots, z_{n})^{T}$ of $n$ i.i.d. standard normal variables.

\item[(2)] Write $\bm{C}$ as:
\[ \bm{C} = \bm{L}\bm{L}^{T}. \]


\item[(3)] It then follows that
\[ {\bm L}{\bf z} \sim \mathcal{N}({\bf 0}, \bm{C}). \]
\end{itemize}
$~~$\\
\end{minipage}
}
\end{center}



Writing $\bm{C} = \bm{L}\bm{L}^{T}$ requires us to find the Cholesky decomposition of ${\bm C}$.


\subsection{The Cholesky Decomposition of real symmetric positive definite matrix}



For our purposes, the variance-covariance matrix ${\bm C}$ will be  real symmetric  and positive definite.



A well-known fact from linear algebra is that the matrix ${\bm C}=(c_{ij})$ is positive definite if and only if there exists a unique lower triangular matrix ${\bm L}=(l_{ij})$, with real and strictly positive diagonal elements, such that ${\bm C} = {\bm L}{\bm L}^{T}$. This factorization is called the \h{Cholesky decomposition} of ${\bm C}$.









\noindent {\bf The algorithm:}~~First, we calculate the values of ${\bm L}=(l_{ij})$ on the main diagonals. Subsequently, we calculate the off-diagonals for the elements below the diagonal:
\begin{eqnarray}
l_{kk} & = & \sqrt{c_{kk}-\sum_{j=1}^{k-1} l_{kj}^{2}} \nonumber \\
l_{ik} & = & \frac{1}{l_{kk}} \left(c_{ik} - \sum_{j=1}^{k-1}l_{ij}l_{kj} \right), ~~i>k.
\end{eqnarray}
 



 
\subsection{Generating correlated Brownian motion}


Suppose ${\bm Z}_t$ is a (column) vector of $n$ independent Brownian motions. Then its variance-covariance matrix is
\[  \mathbb{E}[{\bm Z}_{t}{\bm Z}_{t}^{T}] = \left( \begin{matrix}
t & 0 & 0 & \cdots & 0 \\
0 & t & 0 & \cdots & 0 \\
\vdots & & & & \vdots  \\
 0 & 0  & \cdots & 0  & t
 \end{matrix}\right) = t{\bm I}_{n} \]
where ${\bm I}_{n}$ is the $n \times n $ identity matrix. 
 

\bigskip

Generally, if ${\bm X}_{t}$ is a (column) vector of $n$ correlated Brownian motions, then the variance-covariance matrix is
\[  \mathbb{E}[{\bm X}_{t}{\bm X}_{t}^{T}] = t \left( \begin{matrix}
1& \rho_{12} & \rho_{13} & \cdots & \rho_{1n}\\
\rho_{21} & 1 & \rho_{23}& \cdots & \rho_{2n} \\
\vdots & & & & \vdots  \\
 \rho_{n1} & \rho_{n2}  & \rho_{n3} & \cdots& 1
 \end{matrix}\right) \]
where $\mathbb{E}[z_{i}z_{j}] = \rho_{ij}t = \rho_{ji} t = \mathbb{E}[z_{j}z_{i}]$.
The matrix 
\begin{eqnarray}
{\bm C}^{*} & = &   \left( \begin{matrix}
1& \rho_{12} & \rho_{13} & \cdots & \rho_{1n}\\
\rho_{21} & 1 & \rho_{23}& \cdots & \rho_{2n} \\
\vdots & & & & \vdots  \\
 \rho_{n1} & \rho_{n2}  & \rho_{n3} & \cdots& 1
 \end{matrix}\right) \label{correlation}
 \end{eqnarray}
is called the \h{correlation matrix} of ${\bm X}_{t}$.

\bigskip


\begin{thm}\label{Brownian}
\normalfont
Suppose ${\bm Z}$ is a vector of $n$ independent Brownian motion, and ${\bm C}^{*}$ is the correlation matrix given by (\ref{correlation}). Suppose the Cholesky decomposition of ${\bm C}^{*}$ is given by
\[ {\bm C}^{*} = {\bm L}{\bm L}^{T}. \]
Then ${\bm L}{\bm Z}_{t}$ is a vector of $n$ Brownian motion whose correlation matrix is ${\bm C}^{*}$.
\end{thm}


\bigskip

\begin{corollary}
\normalfont
Suppose $dW^{X}_{t}$ and $dW^{Y}_{t}$ are two standard Brownian motion with $dW^{X}_{t} dW^{Y}_{t} = \rho \ dt$. There exists a standard Brownian motion $dW_{t}$, independent of $dW^{X}_{t}$, such that
\[ dW^{Y}_{t} = \rho \, dW^{X}_{t} + \sqrt{1-\rho^{2}} \, dW_{t}. \] 
\end{corollary}



\begin{proof}
The correlation matrix  of $(W^{X}_{t}, W^{Y}_{t})^{T}$ is 
\[{\bm C}^{*} =  \left( \begin{matrix}
1& \rho \\
\rho & 1
 \end{matrix}\right) \]
The Cholesky decomposition of ${\bm C}^{*}$ is
\[ {\bm C}^{*} = {\bm L}{\bm  L}^{T} \]
where
\[{\bm  L} = \left( \begin{matrix}
1 & 0 \\
\rho & \sqrt{1-\rho^{2}}
\end{matrix} \right). \]
By Theorem \ref{Brownian}, there exist independent Brownian motion $Z_{1,t}$ and $Z_{2,t}$ such that
\[ \left( \begin{matrix}
1 & 0 \\
\rho & \sqrt{1-\rho^{2}}
\end{matrix} \right) \cdot  \left( \begin{matrix}
Z_{1,t}  \\
Z_{2,t}
\end{matrix} \right) =  \left( \begin{matrix}
W^{X}_{t}  \\
W^{Y}_{t}
\end{matrix} \right)  \]
It follows that $Z_{1,t} = W^{X}_{t}$ and
\[ \rho Z_{1,t} + \sqrt{1-\rho^{2}}~Z_{2,t} = W^{Y}_{t}. \]
\end{proof}


\section{Generalized Black-Scholes Market}


From the previous section, we see that correlated Brownian motions can be decomposed into independent ones. Thus, it is sufficient to just consider a market model driven by independent Brownian motions. As a generalisation of the Black-Scholes market with one risky asset (driven by one Brownian motion) and the money market account, we consider a market consisting of $N+1$ assets with the following time-$t$ prices:
\begin{itemize}
\item the risk-less asset: $M_{t}$ (money market account)
\item $N$ risky assets: $S_{1,t}$, $S_{2,t}$, $\ldots$, $S_{N,t}$.
\end{itemize}
Furthermore, we assume that prices are driven by $K$ random factors which are modelled by $K$ {\bf independent} Brownian motions $Z_{1,t}$, $Z_{2,t}$, $\ldots$, $Z_{K,t}$. Notice that we have used the  letter $Z$ instead of the usual $W$ for these Brownian motions; For the sake of clarity, we reserve the letter $W$ for correlated Brownian motions.

A \h{generalized Black-Scholes market} assumes that prices of the underlying assets in the market, under the real-world measure $\mathbb{P}$,  are given by the following system of SDE:
\begin{eqnarray}
dM_{t} & = & rM_{t} \, dt \label{cash} \\
dS_{i,t} & = & \mu_{i} S_{i,t} \, dt + S_{i} \left(\sum_{j=1}^{K} \sigma_{ij} \, dZ_{j,t}\right), ~~1 \le i \le N.\label{assets}
\end{eqnarray}


Few important remarks:
\begin{itemize}
\item The filtration generated by the independent Brownian motions is the information available in the market as time passes. The filtration at any time $t$ is denoted by $\mathcal{F}_{t}$, and it depends only on the Brownian motions up to time $t$: $Z_{1,s}$, $\ldots$, $Z_{K,s}$ for  $s \le t$.

\item For convenience, we assume that the interest rate $r$, the drifts $\mu_{i}$ and volatilities $\sigma_{ij}$ are constants. This is just to help fix ideas more easily, since allowing them to be time-dependent and stochastic (adapted to filtration) would force us to consider some technicalities which are rather distracting. 
\item In general, we do not assume that $N=K$. As we will see later, we need to impose some restriction on $N$ in terms of $K$ so that the market is {\em complete} (i.e. every contingent claim can be replicated by a self-financing portfolio -- which is roughly saying that all risks can be traded).
\end{itemize}


When dealing with quantities with many dimensions, it is often convenient to simplify the notation using vectors. All vectors will be represented by bold letters (big or small), which by default, are column vectors. A row vector will be constructed by transposing a column vector. For example, we have
\begin{eqnarray}
{\bf Z}_{t} & = & \left(\begin{matrix} 
Z_{1,t} \\
\vdots \\
Z_{K,t} \end{matrix} \right), ~~\textnormal{(a $K \times 1$ vector),}\notag \\
{\bf S}_{t} & = & \left( \begin{matrix}
S_{1,t} \\
\vdots \\
S_{N,t} \end{matrix} \right), ~~\textnormal{(a $N \times 1$ vector).} \notag 
\end{eqnarray}

We now introduce the $N \times K$-matrix of the $\sigma_{ij}$'s:
\begin{eqnarray}
{\bf \Sigma} & = & \left( \begin{matrix}
\sigma_{11} & \sigma_{12} & \cdots & \sigma_{1K} \\
\sigma_{21} & \sigma_{22} & \cdots & \sigma_{2K} \\
\vdots & \vdots & & \vdots  \\
\sigma_{N1} & \sigma_{N2} & \cdots & \sigma_{NK} \\
\end{matrix} \right). \label{Sigma}
\end{eqnarray}

We can then  write $(\ref{assets})$ as follows:
\begin{eqnarray}
\left( 
\begin{matrix}
\frac{dS_{1,t}}{S_{1,t}} \\
\vdots \\
\frac{dS_{N,t}}{S_{N,t}} 
\end{matrix}
\right) & = & \left(
\begin{matrix}
\mu_{1} \, dt \\
\mu_{2}  \, dt\\
\vdots \\
\mu_{N} \, dt
\end{matrix}\right) + {\bf \Sigma}  \left(
\begin{matrix}
dZ_{1,t} \\
dZ_{2,t} \\
\vdots \\
dZ_{K,t}
\end{matrix}
\right)
\end{eqnarray}





\begin{defi}[{\bf A general European contingent claim}]
\normalfont
A \h{European contingent claim} $V$ in the generalised Black-Scholes market is a financial instrument whose payoff $V_{T}$ at time $T$ is a $\mathcal{F}_{T}$-measurable random variable. In other words, $V$ is only allowed to depend on the historical paths of ${\bf Z}_{t}$ for $t \le T$.
\end{defi}

An example of such a claim is 
\[ V_{T} = \max\left(\sum_{i=1}^{N} S_{i,T} - K, 0  \right), \] 
which is called a \h{basket option}. We could also consider path-dependent options with payoff
\[ V_{T} = \max\left( \frac{1}{T} \int_{0}^{T}  (a_{1}S_{1,t} + \cdots +  a_{N}S_{N,t}) \, dt -K, 0\right),\]
where $a_{1}$, $\ldots$, $a_{N}$ are some prescribed real constants.



The problem is to price a European contingent claim written on the assets ${\bf S}_{t}$. As we have seen in the one-factor Black-Scholes market, the risk-neutral valuation formula is valid because of two important facts:
\begin{itemize}
\item The existence of the risk-neutral measure $\mathbb{Q}$ (by making use of the Girsanov Theorem);
\item The market is {\em complete} (by making use of the Martingale Representation Theorem).
\end{itemize}

The idea is to extend the above to the generalized Black-Scholes market.


\subsection{Existence of the risk-neutral measure}


We first define what do we mean by a risk-neutral measure in our model with multiple assets.

\begin{defi}[{\bf Risk-neutral/Equivalent Martingale Measure}]
\normalfont 
A probability measure $\mathbb{Q}$ is called a \h{risk-neutral measure} if $\mathbb{Q}$ is equivalent to $\mathbb{P}$ and that the {\em discounted} 
process
\[ \widetilde{S}_{i,t} := \frac{S_{i,t}}{M_{t}},~~\textnormal{for all $1 \le i \le N$}, \]
is a $\mathbb{Q}$-martingale.
\end{defi}



To show that a risk-neutral measure exists, we require a multidimensional version of the Girsanov Theorem.



\begin{thm}[{\bf Multi-dimensional Girsanov Theorem}]
Let $(\theta_{1}, \ldots, \theta_{K})$ be a vector of constants. There exists a measure $\mathbb{Q}$, equivalent to $\mathbb{P}$, such that the process $\widetilde{Z}_{t}$, defined by
\[ d{\widetilde{Z}_{i,t}} = \theta_{i} \, dt + dZ_{i,t}, ~~\textnormal{for}~1 \le i \le K, \]
are independent Brownian motion with respect to $\mathbb{Q}$.
\end{thm}
In general, the constants $\theta_{i}$'s can be replaced by some adapted processes $\theta_{i,t}$, and the conclusion of the theorem will still hold, provided that these $\theta_{i,t}$'s satisfy some technical condition.


We now proceed to find a risk-neutral measure $\mathbb{Q}$. Assuming  such a measure exists, we ``reverse engineer" to determine the required $\theta_{i}$'s.

By Ito's Lemma, 
\[ d\widetilde{S}_{i,t} = (\mu_{i}-r)\widetilde{S}_{i,t} \, dt + \widetilde{S}_{i,t} \sum_{j=1}^{K} \sigma_{ij} \, dZ_{j,t}. \]
Substituting 
\[ d{\widetilde{Z}_{j,t}} = \theta_{j} \, dt + dZ_{j,t}, ~~1 \le i \le K, \]
we have
\[ d\widetilde{S}_{i,t} = \left(\mu_{i}-r - \sum_{j=1}^{K} \sigma_{ij} \theta_{j}\right)\widetilde{S}_{i,t} \, dt + \widetilde{S}_{i,t} \sum_{j=1}^{K} \sigma_{ij} \, d\widetilde{Z}_{j,t}. \]
The Girsanov Theorem ensures that there is an equivalent measure $\mathbb{Q}$ under which each $d\widetilde{Z}_{j,t}$ is a Brownian motion. Since we insist that $\widetilde{S}_{i,t}$ is a $\mathbb{Q}$-martingale, the drift must be zero, i.e.
\begin{eqnarray}
\sum_{j=1}^{K} \sigma_{ij} \theta_{j} & = & \mu_{i} - r.
\end{eqnarray}
Such a  condition must hold for every $i$, $1 \le i \le N$. We can write this condition in the following matrix form:

\begin{eqnarray}
 \left( \begin{matrix}
\sigma_{11} & \sigma_{12} & \cdots & \sigma_{1K} \\
\sigma_{21} & \sigma_{22} & \cdots & \sigma_{2K} \\
\vdots & \vdots & & \vdots  \\
\vdots & \vdots & & \vdots \\
\sigma_{N1} & \sigma_{N2} & \cdots & \sigma_{NK} \\
\end{matrix} \right) \cdot \left( 
\begin{matrix}
\theta_{1} \\
\theta_{2} \\
\vdots \\
\theta_{K}
\end{matrix}
\right)& = & \left( 
\begin{matrix}
\mu_{1}-r \\
\mu_{2}-r \\
\vdots \\
\vdots \\
\mu_{N}-r
\end{matrix}
\right)
\end{eqnarray}
Setting
\[ \bm{\mu}  = \left( \
\begin{matrix}
\mu_{1} \\
\mu_{2} \\
\vdots \\
\vdots \\
\mu_{N}
\end{matrix}
\right), ~~\bm{\theta} = \left(
\begin{matrix}
\theta_{1} \\
\theta_{2} \\
\vdots \\
\theta_{K}
\end{matrix}
\right),
\]
the above condition can be written in a more compact form as:
\[ {\bf \Sigma}{\bm{\theta}} = {\bm{\mu}}- r {\bf 1}, \]
where ${\bf 1}$ is the all-one $N \times 1$ vector.



We have proved the following.
\begin{thm}\label{condition}
With the above notations, if there exists a $K \times 1$ vector $\bm{\theta}$ such that ${\bf \Sigma}{\bm{\theta}} = {\bm{\mu}}- r {\bf 1}$, then there exists a risk-neutral measure $\mathbb{Q}$ for the generalised Black-Scholes market.
\end{thm}


\noindent {\bf Remark.}~~
\begin{itemize}
\item[(1)]  Unfortunately, the equation ${\bf \Sigma}{\bm{x}} = {\bm{\mu}}- r {\bf 1}$ in the variable $\bm{x} = (x_{1}, \ldots, x_{K})^{T}$ does not always admit a solution in general. This was never an issue in the one-factor model since we can always solve for $\theta$:
\[ \theta = \frac{\mu-r}{\sigma}, \]
because we always assume $\sigma \not = 0$.

\item[(2)] In the generalised setting, there may NOT exist any solution to the equation ${\bf \Sigma}{\bm{x}} = {\bm{\mu}}- r {\bf 1}$, even if we assume all $\sigma_{ij}$'s are non-zero. 

Here is one example: Take $N=2$, $K=1$, $\bm{\mu} = (\mu_{1}, \mu_{2})^{T}$ where $\mu_{1} \not = \mu_{2}$, and 
\[ \Sigma = \left(
\begin{matrix}
\sigma \\
\sigma 
\end{matrix}
\right). \]

If there is a solution $\bm{\theta} = (\theta)$ to the equation ${\bf \Sigma}{\bm{x}} = {\bm{\mu}}- r {\bf 1}$, then
\[ \left\{
\begin{tabular}{ccc}
$\sigma \theta$  & = &  $\mu_{1} - r$, \\
$\sigma \theta$ & = &  $\mu_{2} - r$.
\end{tabular}\right.\]
This implies that $\mu_{1} = \mu_{2}$, which is a contradiction.


\end{itemize}



Therefore, we cannot guarantee that risk-neutral measures exist. Luckily, this won't happen if there is no arbitrage in the market.


A portfolio can be regarded as a vector-valued process $(\phi_{0,t}, \phi_{1, t}, \ldots, \phi_{N, t})$ such that at any time $t$, the investor holds the following quantities of the underlying assets:
\begin{itemize}
\item $\phi_{0,t}$ units of money market accounts;
\item $\phi_{i,t}$ units of the asset $S_{i,t}$, for $1 \le i \le N$.
\end{itemize}
Clearly, we require each $\phi_{i,t}$ to be adapted to the filtration $\mathcal{F}_{t}$. At any time $t$, the value of a portfolio is given by
\begin{eqnarray}
 \Pi_{t} & = &  \phi_{0,t}M_{t} + \sum_{i=1}^{N} \phi_{i,t} S_{i,t} \notag 
\end{eqnarray}
The portfolio is \h{self-financing} if
\begin{eqnarray}
\, d\Pi_{t} & = & \phi_{0,t} \, dM_{t} + \sum_{i=1}^{N} \phi_{i,t} \, dS_{i,t}. \label{self-financing}
\end{eqnarray}





\begin{thm}
Suppose there is no arbitrage opportunities in the generalised Black-Scholes market. Then there exists a risk-neutral measure $\mathbb{Q}$.
\end{thm}

\begin{proof}
We shall prove the contrapositive. Suppose there does not exist a risk-neutral measure. By Theorem \ref{condition},  
\[ \bm{\Sigma} \bm{x} \not = \bm{\mu} - r {\bm{1}}~~\textnormal{for all vector $\bm{x} \in \mathbb{R}^{K}$}. \]
This says that $\bm{\mu}-r{\bm{1}}$ is not in the image $\textnormal{Im}(\bm{\Sigma})$ of $\bm{\Sigma}: \mathbb{R}^{K} \rightarrow \mathbb{R}^{N}$.


By a general theorem in linear algebra, 
\[ \textnormal{Im}(\bm{\Sigma}) = \textnormal{Ker}(\bm{\Sigma}^{T})^{\bot}, \]
where $\textnormal{Ker}(\bm{\Sigma}^{T})^{\bot}$ is the set of $N \times 1$ vectors that are orthogonal to the kernel of $\bm{\Sigma}^{T}: \mathbb{R}^{N} \rightarrow \mathbb{R}^{K}$. It follows that $\textnormal{Ker}(\bm {\Sigma}^{T}) \not = \{\bm 0\}$, and so there exists a vector $\bm{\phi} \in \mathbb{R}^{N}$:
\[ \bm{\phi} = \left( 
\begin{matrix}
\phi_{1} \\
\vdots \\
\phi_{N}
\end{matrix}
\right) \not = \bm{0}\]
such that $\bm{\phi} \in \textnormal{Ker}(\bm{\Sigma}^{T})$ (i.e. $\bm{\Sigma}^{T} \bm{\phi} = \bm{0}$) and $\bm{\phi} \cdot ({\bm{\mu}} - r \bm{1}) \not = 0$. Without loss of generality, we may assume that
\begin{eqnarray}
\bm{\Sigma}^{T} \bm{\phi} & = & \bm{0}, \label{c1} \\
\bm{\phi} \cdot ({\bm{\mu}} - r \bm{1}) & > &   0, \label{c2}
\end{eqnarray}
since if $\bm{\phi} \cdot ({\bm{\mu}} - r \bm{1}) <0$, we can replace $\bm{\phi}$ by $-\bm{\phi}$.



We will now construct a self-financing portfolio that generates an arbitrage opportunity. Consider the portfolio $\Pi_{t}$, $0 \le t \le T$, given by:
\[ \Pi_{t} = \psi_{0,t} \, M_{t} + \sum_{i=1}^{N} \psi_{i,t} S_{i,t}, \]
where we have set
\[ \psi_{i,t} = \frac{\phi_{i,t}M_{t}}{S_{i,t}},~~\textnormal{for}~ 1 \le i \le N,\]
and have chosen $\psi_{0,t}$ so that the initial value of the portfolio is $0$ and that the portfolio is self-financing -- this can always be done since we can always borrow from the money market if there is a shortfall from positions in the risky assets, and invest in the money market in if there is a surplus. Thus,

\begin{eqnarray}
d\Pi_{t} & = &  \psi_{0,t} rM_{t}\, dt + \sum_{i=1}^{N} \psi_{i,t} dS_{i,t}. \label{sf-01}
\end{eqnarray}
By Ito's Lemma,
\begin{eqnarray}
d\left( \frac{\Pi_{t}}{M_{t}}\right) & = & -r \frac{\Pi_{t}}{M_{t}} \, dt + \frac{1}{M_{t}} \, d\Pi_{t}. \label{ito}
\end{eqnarray}



Substituting (\ref{sf-01}) into (\ref{ito}), we obtain
\begin{eqnarray}
d\left( \frac{\Pi_{t}}{M_{t}}\right) & = & -r \frac{\Pi_{t}}{M_{t}} \, dt + \frac{1}{M_{t}} \, \left( \psi_{0,t} rM_{t}\, dt + \sum_{i=1}^{N} \psi_{i,t} dS_{i,t}\right) \notag  \\
& = & -r \frac{\Pi_{t}}{M_{t}} \, dt + r \psi_{0,t} \, dt + \sum_{i=1}^{N} \psi_{i,t} \frac{dS_{i,t}}{M_{t}} \\
& = & -r \frac{\Pi_{t}}{M_{t}} \, dt + r \psi_{0,t} \, dt + \sum_{i=1}^{N} \psi_{i,t} \left(d\left( \frac{S_{t}}{M_{t}}\right) + r \frac{S_{t}}{M_{t}} \, dt \right)\\
& = & -r\frac{\Pi_{t}}{M_{t}} \, dt + r \left(\frac{\psi_{0,t}M_{t} +\sum_{i=1}^{N} \psi_{i,t} S_{i,t}}{M_{t}}\right)\, dt + \sum_{i=1}^{N} \psi_{i,t} d\left( \frac{S_{t}}{M_{t}}\right) \\
& = & -r\frac{\Pi_{t}}{M_{t}} \, dt + r\frac{\Pi_{t}}{M_{t}} \, dt+ \sum_{i=1}^{N} \psi_{i,t} d\left( \frac{S_{t}}{M_{t}}\right) \\
& = & \sum_{i=1}^{N} \psi_{i,t} d\widetilde{S}_{i,t} \\
& = & \sum_{i=1}^{N} \psi_{i,t} \left( (\mu_{i}-r)\widetilde{S}_{i,t} \, dt + \widetilde{S}_{i,t} \sum_{j=1}^{K} \sigma_{ij} \, dZ_{j,t}\right) \\
& = & \sum_{i=1}^{N} \phi_{i,t} \left( (\mu_{i}-r) \, dt + \sum_{j=1}^{K} \sigma_{ij} \, dZ_{j,t}\right)  \\
& = & \sum_{i=1}^{N} \phi_{i,t} (\mu_{i}-r) \, dt + \sum_{i=1}^{N} \sum_{j=1}^{K} \phi_{i,t}\sigma_{ij} \, dZ_{j,t}
\end{eqnarray}


\begin{eqnarray}
d\left( \frac{\Pi_{t}}{M_{t}}\right) & = & \sum_{i=1}^{N} \phi_{i,t} (\mu_{i}-r) \, dt + \sum_{j=1}^{K} \sum_{i=1}^{N} \phi_{i,t}\sigma_{ij} \, dZ_{j,t} \\
& = & \sum_{i=1}^{N} \phi_{i,t} (\mu_{i}-r) \, dt +  \sum_{i=1}^{K} \left(\bm{\Sigma}^{T} \bm{\phi} \right)_{j} \, dZ_{j,t}
\end{eqnarray}
where $\left(\bm{\Sigma}^{T} \bm{\phi} \right)_{j}$ is the $j$-th entry of the $K \times 1$ vector $\left(\bm{\Sigma}^{T} \bm{\phi} \right)$. By (\ref{c1}), we deduce that
\begin{eqnarray}
d\left( \frac{\Pi_{t}}{M_{t}}\right) & = &  \sum_{i=1}^{N} \phi_{i,t} (\mu_{i}-r) \, dt \notag \\
& = & \bm{\phi} \cdot (\bm{\mu}-r \bm{1}) \, dt
\end{eqnarray}

It follows from (\ref{ito}) that
\begin{eqnarray}
d \Pi_{t} & = &  r \Pi_{t} \, dt + M_{t} \cdot d\left( \frac{\Pi_{t}}{M_{t}}\right) \notag \\
& = & r\Pi_{t} \, dt + \bm{\phi} \cdot (\bm{\mu}-r \bm{1}) M_{t}\, dt \notag \\
& > & r\Pi_{t} \, dt.
\end{eqnarray}
We have just shown that the portfolio $\Pi_{t}$ is risk-less with $0$ initial outlay and positive growth rate. This is obviously an arbitrage opportunity!
\end{proof}

In fact, the converse of the above theorem is also true (Exercise). We summarise these results as follows.

\begin{thm}
The following are equivalent in the generalised Black-Scholes market:
\begin{itemize}
\item[(i)] There is no arbitrage opportunities.
\item[(ii)] There exists a risk-neutral measure.
\item[(iii)] There exists a solution to the equation $\bm{\Sigma}\bm{x} = \bm{\mu} - r\bm{1}$.
\end{itemize}
In the special case when $N=K$ and $\bm{\Sigma}$ is invertible, then all of the above hold. Moreover, there is a unique solution to $\bm{x} = \bm{\Sigma}^{-1}(\bm{\mu} - r\bm{1})$.
\end{thm}



\subsection{Market Completeness}

Form now on, we are going to assume that  our market has a risk-neutral measure $\mathbb{Q}$. This implies that
\begin{eqnarray}
d\widetilde{S}_{i,t} & = &  \widetilde{S}_{i,t} \sum_{j=1}^{K} \sigma_{ij} \, d \widetilde{Z}_{j,t}. \notag
\end{eqnarray}

Consider a European contingent claim $V$. We say that $V$ is \h{replicable} (or \h{attainable}) if there exists a self-financing portfolio $\Pi_{t}$ such that $\Pi_{T} = V_{T}$.  Let us now discuss what it takes in order to be able to replicate $V$.









Define the variable  $U_{t}$ by 
\[ U_{t} = \mathbb{E}^{\mathbb{Q}}_{t}\left[ \frac{V_{T}}{M_{T}} \right]. \]
By iterated conditioning, $U_{t}$ is a $\mathbb{Q}$-martingale. By a suitable extension of the Martingale Representation Theorem, we will be able to write $U_{t}$ as
\[ dU_{t} = \sum_{j=1}^{K} \eta_{j,t} \, d\widetilde{Z}_{j,t}\]
for some adapted vector processes $(\eta_{1,t}, \ldots, \eta_{K,t})$.



The key step in replicating $V$ is to convert $d\widetilde{Z}_{j,t}$ into $d\widetilde{S}_{j,t}$ (all the other steps are similar to those in the one-factor model and can be readily extended, so we will not discuss them here). In the one-factor Black-Scholes model, this step was straight forward. However in the multi-dimensional setting, we are actually dealing with the solution to a system of linear equations. In particular, we want to go from 
\begin{eqnarray}
\frac{d\widetilde{S}_{i,t}}{\widetilde{S}_{i,t}} & = &   \sum_{j=1}^{K} \sigma_{ij} \, d \widetilde{Z}_{j,t}, ~~1 \le i \le N \label{rn}
\end{eqnarray}
to
\begin{eqnarray}
d\widetilde{Z}_{j,t} & = & \sum_{l=1}^{n} \gamma_{jl}\frac{d\widetilde{S}_{l,t}}{\widetilde{S}_{l,t}}, ~~1 \le j \le K \label{sol}
\end{eqnarray}
for suitable coefficients $\gamma_{jl}$. The equations (\ref{rn}) and (\ref{sol}) demand that 
\[ \left(
\begin{matrix}
d\widetilde{Z}_{1,t} \\
\vdots \\
d\widetilde{Z}_{K,t}
\end{matrix} \right) \]
 is the only solution to the following system of linear equations in the variable $\bm{x}=(x_{1}, \ldots, x_{K})^{T}$:
\begin{eqnarray}
\left( 
\begin{matrix}
\sigma_{11} & \sigma_{12} & \cdots & \sigma_{1K} \\
\vdots & & & \vdots \\
\vdots & & & \vdots \\
\vdots & & & \vdots \\
\sigma_{N1} & \sigma_{N2} & \cdots & \sigma_{NK}
\end{matrix}
\right) \left(
\begin{matrix}
x_{1} \\
x_{2} \\
\vdots \\
x_{K}
\end{matrix}
\right) & = & \left(
\begin{matrix}
\frac{d\widetilde{S}_{1,t}}{\widetilde{S}_{1,t}} \\
\vdots \\
\vdots \\
\vdots \\
\frac{d\widetilde{S}_{N,t}}{\widetilde{S}_{N,t}}
\end{matrix}
\right)
\end{eqnarray}
Therefore, by standard linear algebra, this is only possible if 
\[ \textnormal{rank}(\bm{\Sigma}) = \textnormal{number of rows in $\bm{x}$} = K. \]
Recall that $\min\{N,K\} \ge \textnormal{rank}(\bm{\Sigma})$. This amounts to saying that
\begin{itemize}
\item $N \ge K$; and
\item the $K$ column vectors of $\bm{\Sigma}$ are all independent, i.e. $\bm{\Sigma}$ has full column rank (so it has left inverse).
\end{itemize}
In this case, the solution $\bm{\Sigma} \bm{x} = \bm{\mu} -r\bm{1}$ will be uique as well, and thus there will be exactly one unique risk-neutral measure. The condition $N \ge K$ says that in order to have a complete market it is necessary to have at least as many assets as there are risk factors.




\begin{defi}[{\bf Complete Market}]
The generalised Black-Scholes market is \h{complete} if every European contingent claim can be replicated by some self-financing portfolio (trading strategy).
\end{defi}

We now summarize what we have shown:

\begin{thm}[{\bf Risk-neutral pricing}]
Suppose that the generalized Black-Scholes market does not admit arbitrage. Then there exists a risk-neutral measure $\mathbb{Q}$. Moreover, this market is complete if and only if
\begin{itemize}
\item $N \ge K$, and 
\item the $N \times K$ matrix $\bm{\Sigma}$ has full column rank $K$.
\end{itemize}
In this case, the measure $\mathbb{Q}$ is unique and  we can price any European contingent claim $V$ by the formula
\[ V_{t} = M_{t} \mathbb{E}^{\mathbb{Q}}_{t} \left[ \frac{V_{T}}{M_{T}}\right]. \]

\noindent Note that if $N=K$, the condition on $\bm{\Sigma}$ is simply  that $\bm{\Sigma}$ is an invertible square matrix.
\end{thm}


</body>
</html>
